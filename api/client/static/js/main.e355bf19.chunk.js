(this.webpackJsonpclientchat=this.webpackJsonpclientchat||[]).push([[0],{182:function(e,n,t){},183:function(e,n,t){},303:function(e,n,t){"use strict";t.r(n);var a=t(3),r=t(0),i=t.n(r),c=t(16),s=t.n(c),o=(t(182),t(183),t(26)),u=t(58),l=t(18),d="/",j="/login",p="/register",b="/chat",m=t(45),x=t.n(m),h=t(64),f=t(30),O=t(343),g=t(342),v=t(337),w=t(340),I=t(339),y=t(338),k=t(99),S=t.n(k),C=t(307),N=t(333),T=t(335),q=t(36),B=t(57),F=t.n(B);function E(){var e=Object(q.a)(["\n  mutation userSignIn($input: UserSignInInput!){\n    userSignIn(input: $input){\n      id\n      userName\n      token\n    }\n  }\n"]);return E=function(){return e},e}function M(){var e=Object(q.a)(["\n  mutation createUser($input: NewUser!){\n    createUser(input: $input){\n      name\n      email\n      id\n    }\n  }\n"]);return M=function(){return e},e}var W=F()(M()),P=F()(E()),V=t(39),R=t(56),$=t(33),A=t(68),L=t.n(A),U=t(22),D=t.n(U),H=t(42),z=(t(144),{email:"",password:""}),G=$.a().shape({email:$.b().required().test("err","err",(function(e){return!!e&&e.includes("@")})),password:$.b().required().min(6)}),_=Object(N.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));function J(){var e=_(),n=Object(l.e)(),t=Object(V.a)(P),i=Object(f.a)(t,1)[0],c=function(){var e=Object(h.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.errors.email||t.errors.password){e.next=10;break}return e.prev=1,e.next=4,i({variables:{input:{email:t.values.email,password:t.values.password}}}).then((function(e){L()(e,"data.userSignIn")?(D.a.set("userId",L()(e,"data.userSignIn.id")),D.a.set("userName",L()(e,"data.userSignIn.userName")),D.a.set("token",L()(e,"data.userSignIn.token")),n.push(b)):H.b.error("Email or password entered incorrect",{position:H.b.POSITION.BOTTOM_RIGHT})}));case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:e.next=11;break;case 10:H.b.error("Email or password entered incorrect",{position:H.b.POSITION.BOTTOM_RIGHT});case 11:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(n){return e.apply(this,arguments)}}();return Object(a.jsxs)(r.Fragment,{children:[Object(a.jsx)(R.b,{onSubmit:function(e){return console.log(e)},initialValues:z,validationSchema:G,component:function(n){return Object(a.jsxs)(T.a,{component:"main",maxWidth:"xs",children:[Object(a.jsx)(v.a,{}),Object(a.jsxs)("div",{className:e.paper,children:[Object(a.jsx)(O.a,{className:e.avatar,children:Object(a.jsx)(S.a,{})}),Object(a.jsx)(C.a,{component:"h1",variant:"h5",children:"Sign in"}),Object(a.jsxs)("form",{className:e.form,noValidate:!0,children:[Object(a.jsx)(w.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"new-password",inputProps:{form:{autocomplete:"off"}},onChange:function(){return function(e){var n=document.getElementById("email");n&&e.setFieldValue("email",n.value)}(n)},autoFocus:!0}),Object(a.jsx)(w.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",onChange:function(){return function(e){var n=document.getElementById("password");n&&e.setFieldValue("password",n.value)}(n)},autoComplete:"new-password"}),Object(a.jsx)(g.a,{fullWidth:!0,variant:"contained",color:"primary",className:e.submit,onClick:function(){return c(n)},children:"Sign In"}),Object(a.jsx)(y.a,{container:!0,children:Object(a.jsx)(y.a,{item:!0,children:Object(a.jsx)(I.a,{href:p,variant:"body2",children:"Don't have an account? Sign Up"})})})]})]})]})}}),Object(a.jsx)(H.a,{})]})}var K={email:"",password:"",name:""},Q=$.a().shape({email:$.b().required(),password:$.b().required().min(6),name:$.b().required()}),X=Object(N.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(3)},submit:{margin:e.spacing(3,0,2)}}}));function Y(){var e=X(),n=Object(r.useRef)(null),t=Object(r.useRef)(null),i=Object(r.useRef)(null),c=Object(V.a)(W),s=Object(f.a)(c,1)[0],o=Object(l.e)(),u=function(){var e=Object(h.a)(x.a.mark((function e(n){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s({variables:{input:{email:n.email,name:n.name,password:n.password}}});case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:return e.prev=7,o.push(j),e.finish(7);case 10:case"end":return e.stop()}}),e,null,[[0,5,7,10]])})));return function(n){return e.apply(this,arguments)}}();return Object(a.jsx)(R.b,{onSubmit:u,initialValues:K,validationSchema:Q,component:function(r){return Object(a.jsxs)(T.a,{component:"main",maxWidth:"xs",children:[Object(a.jsx)(v.a,{}),Object(a.jsxs)("div",{className:e.paper,children:[Object(a.jsx)(O.a,{className:e.avatar,children:Object(a.jsx)(S.a,{})}),Object(a.jsx)(C.a,{component:"h1",variant:"h5",children:"Sign up"}),Object(a.jsxs)(R.a,{id:"test",className:e.form,children:[Object(a.jsxs)(y.a,{container:!0,spacing:2,children:[Object(a.jsx)(y.a,{item:!0,xs:12,children:Object(a.jsx)(w.a,{name:"name",variant:"outlined",required:!0,fullWidth:!0,id:"name",label:"Name",autoFocus:!0,ref:n,onBlur:function(){return function(e){var n=document.getElementById("name");n&&(e.setFieldValue("name",n.value),console.log(n.value))}(r)},autoComplete:"new-password"})}),Object(a.jsx)(y.a,{item:!0,xs:12,children:Object(a.jsx)(w.a,{variant:"outlined",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",ref:t,onBlur:function(){return function(e){var n=document.getElementById("email");n&&e.setFieldValue("email",n.value)}(r)},autoComplete:"new-password"})}),Object(a.jsx)(y.a,{item:!0,xs:12,children:Object(a.jsx)(w.a,{variant:"outlined",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",ref:i,onBlur:function(){return function(e){var n=document.getElementById("password");n&&e.setFieldValue("password",n.value)}(r)},autoComplete:"new-password"})})]}),Object(a.jsx)(g.a,{fullWidth:!0,variant:"contained",color:"primary",className:e.submit,onClick:function(){return u(r.values)},children:"Sign Up"}),Object(a.jsx)(y.a,{container:!0,justify:"flex-end",children:Object(a.jsx)(y.a,{item:!0,children:Object(a.jsx)(I.a,{href:j,variant:"body2",children:"Already have an account? Sign in"})})})]})]})]})}})}var Z=t(341),ee=t(31);function ne(){var e=Object(q.a)(["\n  subscription{\n    newMessage {\n    text\n    date\n    senderName\n  }\n  }\n\n"]);return ne=function(){return e},e}function te(){var e=Object(q.a)(["\n  query getMessages($senderId: String){\n    getMessages(senderId: $senderId){\n      text\n      senderName\n      date\n    }\n  }\n"]);return te=function(){return e},e}function ae(){var e=Object(q.a)(["\n  mutation sendMessage($input: NewMessage!){\n    sendMessage(input: $input){\n      text\n    }\n  }\n"]);return ae=function(){return e},e}var re=F()(ae()),ie=F()(te()),ce=F()(ne()),se=t(80);function oe(){var e=Object(q.a)(["\n  padding-bottom: 10px;\n  padding-top: 10px;\n  border: 1px solid rgb(63, 81, 181);\n  border-radius: 10px;\n  margin-top:10px;\n  margin-bottom:10px;\n"]);return oe=function(){return e},e}function ue(){var e=Object(q.a)(["\n  padding-left:10px;\n  padding-right:10px;\n  list-style:none;\n"]);return ue=function(){return e},e}var le=se.a.ul(ue()),de=se.a.li(oe()),je=function(){var e=D.a.get("userId"),n=Object(r.useState)([""]),t=Object(f.a)(n,2),i=t[0],c=t[1],s=Object(V.b)(ie,{variables:{senderId:e}}),o=s.data,u=s.loading;Object(r.useEffect)((function(){c(o.getMessages)}),[u,o]);var l=Object(V.c)(ce),d=l.data,j=l.loading;return Object(r.useEffect)((function(){var e=document.getElementById("messageList");if(d&&e){var n=[].concat(Object(ee.a)(i),[d.newMessage]);c(n),e.scrollTop=e.scrollHeight}}),[j,d]),Object(a.jsx)(Z.a,{width:"100vw",height:"70vh",id:"messageList",overflow:"scroll",children:Object(a.jsx)(le,{children:!u&&i&&i.map((function(e,n){return Object(a.jsxs)(de,{children:[Object(a.jsxs)(Z.a,{textAlign:"left",marginLeft:"10px",children:[e.senderName,": "]}),Object(a.jsx)(Z.a,{marginTop:"20px",children:e.text})]},n)}))})})};function pe(){var e=Object(q.a)(["\n  width:300px;\n  border:1px solid #3f51b5;\n  border-radius:5px;\n"]);return pe=function(){return e},e}var be=Object(se.a)(w.a)(pe()),me={senderId:"",text:""},xe=$.a().shape({text:$.b().required().max(500),senderId:$.b().required()}),he=function(){var e=Object(V.a)(re),n=Object(f.a)(e,1)[0],t=D.a.get("userId"),i=D.a.get("userName"),c=function(){var e=Object(h.a)(x.a.mark((function e(a){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.values.text||a.errors.text){e.next=13;break}return e.prev=1,e.next=4,n({variables:{input:{senderId:t,text:a.values.text,senderName:i}}});case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:return e.prev=8,a.resetForm(),e.finish(8);case 11:e.next=15;break;case 13:H.b.error("Max lenght 500 simbols",{position:H.b.POSITION.BOTTOM_RIGHT}),a.resetForm();case 15:case"end":return e.stop()}}),e,null,[[1,6,8,11]])})));return function(n){return e.apply(this,arguments)}}();return Object(a.jsxs)(r.Fragment,{children:[Object(a.jsx)(R.b,{onSubmit:function(){return n()},initialValues:me,validationSchema:xe,component:function(e){return Object(a.jsxs)(Z.a,{width:"300px",height:"150px",children:[Object(a.jsx)(be,{id:"sendMessageInput",required:!0,variant:"outlined",autoComplete:"off",onChange:function(){return function(e){var n=document.getElementById("sendMessageInput");n&&e.setFieldValue("text",n.value)}(e)},inputProps:{autoComplete:"none"}}),Object(a.jsx)(Z.a,{marginTop:"10px",children:Object(a.jsx)(g.a,{variant:"contained",color:"primary",onClick:function(){return c(e)},children:"send "})})]})}}),Object(a.jsx)(H.a,{})]})},fe=function(){var e=D.a.get("userId"),n=Object(l.e)();return Object(r.useEffect)((function(){!e&&n.push(j)}),[n,e]),Object(a.jsxs)(Z.a,{width:"100vw",height:"90vh",display:"flex",justifyContent:"center",children:[Object(a.jsx)(Z.a,{children:Object(a.jsx)(je,{})}),Object(a.jsx)(Z.a,{position:"fixed",bottom:"0",children:Object(a.jsx)(he,{})})]})},Oe=function(){var e=Object(l.e)();return Object(a.jsxs)(Z.a,{width:"100vw",height:"50px",bgcolor:"#3f51b5",display:"flex",justifyContent:"center",alignItems:"center",children:[Object(a.jsx)(Z.a,{width:"50vw",display:"flex",justifyContent:"flex-start",marginLeft:"10px",fontSize:"32px",color:"white",fontWeight:"500",children:" WebChat "}),Object(a.jsx)(Z.a,{display:"flex",justifyContent:"flex-end",width:"50vw",children:D.a.get("userId")?Object(a.jsx)(Z.a,{bgcolor:"white",border:"1px solid white",borderRadius:"10px",margin:"5px 10px",height:"40px",textAlign:"center",children:Object(a.jsx)(g.a,{onClick:function(){D.a.remove("userId"),D.a.remove("userName"),e.push(j)},color:"primary",children:"logout"})}):Object(a.jsx)(Z.a,{bgcolor:"white",border:"1px solid white",borderRadius:"10px",margin:"5px 10px",height:"40px",textAlign:"center",children:Object(a.jsx)(g.a,{onClick:function(){e.push(j)},color:"primary",children:"login"})})})]})},ge=function(){return Object(a.jsxs)(u.a,{children:[Object(a.jsx)(l.a,{path:d,children:Object(a.jsx)(Oe,{})}),Object(a.jsx)(l.a,{path:j,exact:!0,children:Object(a.jsx)(J,{})}),Object(a.jsx)(l.a,{path:p,exact:!0,children:Object(a.jsx)(Y,{})}),Object(a.jsx)(l.a,{path:b,exact:!0,children:Object(a.jsx)(fe,{})})]})},ve=t(116),we=t(28),Ie=t(161),ye=t(51),ke=t(158),Se=t(8),Ce=t(160),Ne=t(159),Te=new ke.a({uri:"ws://18.222.35.142:5000/graphql",options:{reconnect:!0,connectionParams:function(){return{autorization:D.a.get("token")?"Bearer ".concat(D.a.get("token")):""}}}}),qe=new Ie.a({uri:"http://18.222.35.142:5000/graphql"}),Be=Object(Ne.a)((function(e,n){var t=n.headers,a=D.a.get("token");return{headers:Object(ve.a)(Object(ve.a)({},t),{},{autorization:a?"Bearer ".concat(a):""})}})),Fe=Object(we.d)((function(e){var n=e.query,t=Object(Se.j)(n);return"OperationDefinition"===t.kind&&"subscription"===t.operation}),Te,Be.concat(qe)),Ee=new ye.a({cache:new Ce.a,link:Fe});var Me=function(){return Object(a.jsx)(o.a,{client:Ee,children:Object(a.jsx)("div",{className:"App",children:Object(a.jsx)(ge,{})})})},We=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,346)).then((function(n){var t=n.getCLS,a=n.getFID,r=n.getFCP,i=n.getLCP,c=n.getTTFB;t(e),a(e),r(e),i(e),c(e)}))};s.a.render(Object(a.jsx)(i.a.StrictMode,{children:Object(a.jsx)(Me,{})}),document.getElementById("root")),We()}},[[303,1,2]]]);
//# sourceMappingURL=main.e355bf19.chunk.js.map