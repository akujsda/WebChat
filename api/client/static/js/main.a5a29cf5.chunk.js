(this.webpackJsonpclientchat=this.webpackJsonpclientchat||[]).push([[0],{182:function(e,n,t){},183:function(e,n,t){},303:function(e,n,t){"use strict";t.r(n);var a=t(3),r=t(0),i=t.n(r),s=t(16),c=t.n(s),o=(t(182),t(183),t(26)),u=t(29),l=t(54),d=t(18),j="/",p="/login",b="/register",m="/chat",x=t(45),h=t.n(x),f=t(66),O=t(343),g=t(342),v=t(337),w=t(340),I=t(339),y=t(338),S=t(99),k=t.n(S),C=t(307),N=t(333),T=t(335),q=t(36),B=t(59),F=t.n(B);function M(){var e=Object(q.a)(["\n  mutation userSignIn($input: UserSignInInput!){\n    userSignIn(input: $input){\n      id\n      userName\n      token\n    }\n  }\n"]);return M=function(){return e},e}function E(){var e=Object(q.a)(["\n  mutation createUser($input: NewUser!){\n    createUser(input: $input){\n      name\n      email\n      id\n    }\n  }\n"]);return E=function(){return e},e}var W=F()(E()),P=F()(M()),V=t(39),R=t(58),U=t(33),$=t(51),A=t.n($),D=t(22),L=t.n(D),H=t(42),z=(t(144),{email:"",password:""}),G=U.a().shape({email:U.b().required().test("err","err",(function(e){return!!e&&e.includes("@")})),password:U.b().required().min(6)}),_=Object(N.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));function J(e){var n=e.setUserId,t=(e.userId,_()),i=Object(d.e)(),s=Object(V.a)(P),c=Object(u.a)(s,1)[0],o=function(){var e=Object(f.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.errors.email||t.errors.password){e.next=11;break}return console.log(t.values),e.prev=2,e.next=5,c({variables:{input:{email:t.values.email,password:t.values.password}}}).then((function(e){A()(e,"data.userSignIn")?(n(A()(e,"data.userSignIn")),L.a.set("userId",A()(e,"data.userSignIn.id")),L.a.set("userName",A()(e,"data.userSignIn.userName")),L.a.set("token",A()(e,"data.userSignIn.token")),i.push(m)):(H.b.error("Email or password entered incorrect",{position:H.b.POSITION.BOTTOM_RIGHT}),console.log(e)),console.log(A()(e,"data.userSignIn"))}));case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(2);case 9:e.next=12;break;case 11:H.b.error("Email or password entered incorrect",{position:H.b.POSITION.BOTTOM_RIGHT});case 12:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(n){return e.apply(this,arguments)}}();return Object(a.jsxs)(r.Fragment,{children:[Object(a.jsx)(R.b,{onSubmit:function(e){return console.log(e)},initialValues:z,validationSchema:G,component:function(e){return Object(a.jsxs)(T.a,{component:"main",maxWidth:"xs",children:[Object(a.jsx)(v.a,{}),Object(a.jsxs)("div",{className:t.paper,children:[Object(a.jsx)(O.a,{className:t.avatar,children:Object(a.jsx)(k.a,{})}),Object(a.jsx)(C.a,{component:"h1",variant:"h5",children:"Sign in"}),Object(a.jsxs)("form",{className:t.form,noValidate:!0,children:[Object(a.jsx)(w.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"new-password",inputProps:{form:{autocomplete:"off"}},onChange:function(){return function(e){var n=document.getElementById("email");n&&e.setFieldValue("email",n.value)}(e)},autoFocus:!0}),Object(a.jsx)(w.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",onChange:function(){return function(e){var n=document.getElementById("password");n&&e.setFieldValue("password",n.value)}(e)},autoComplete:"new-password"}),Object(a.jsx)(g.a,{fullWidth:!0,variant:"contained",color:"primary",className:t.submit,onClick:function(){return o(e)},children:"Sign In"}),Object(a.jsx)(y.a,{container:!0,children:Object(a.jsx)(y.a,{item:!0,children:Object(a.jsx)(I.a,{href:b,variant:"body2",children:"Don't have an account? Sign Up"})})})]})]})]})}}),Object(a.jsx)(H.a,{})]})}var K={email:"",password:"",name:""},Q=U.a().shape({email:U.b().required(),password:U.b().required().min(6),name:U.b().required()}),X=Object(N.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(3)},submit:{margin:e.spacing(3,0,2)}}}));function Y(){var e=X(),n=Object(r.useRef)(null),t=Object(r.useRef)(null),i=Object(r.useRef)(null),s=Object(V.a)(W),c=Object(u.a)(s,1)[0],o=Object(d.e)(),l=function(){var e=Object(f.a)(h.a.mark((function e(n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c({variables:{input:{email:n.email,name:n.name,password:n.password}}});case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:return e.prev=7,o.push(p),e.finish(7);case 10:case"end":return e.stop()}}),e,null,[[0,5,7,10]])})));return function(n){return e.apply(this,arguments)}}();return Object(a.jsx)(R.b,{onSubmit:function(e){return console.log(e)},initialValues:K,validationSchema:Q,component:function(r){return Object(a.jsxs)(T.a,{component:"main",maxWidth:"xs",children:[Object(a.jsx)(v.a,{}),Object(a.jsxs)("div",{className:e.paper,children:[Object(a.jsx)(O.a,{className:e.avatar,children:Object(a.jsx)(k.a,{})}),Object(a.jsx)(C.a,{component:"h1",variant:"h5",children:"Sign up"}),Object(a.jsxs)(R.a,{id:"test",className:e.form,children:[Object(a.jsxs)(y.a,{container:!0,spacing:2,children:[Object(a.jsx)(y.a,{item:!0,xs:12,children:Object(a.jsx)(w.a,{name:"name",variant:"outlined",required:!0,fullWidth:!0,id:"name",label:"Name",autoFocus:!0,ref:n,onBlur:function(){return function(e){var n=document.getElementById("name");n&&(e.setFieldValue("name",n.value),console.log(n.value))}(r)},autoComplete:"new-password"})}),Object(a.jsx)(y.a,{item:!0,xs:12,children:Object(a.jsx)(w.a,{variant:"outlined",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",ref:t,onBlur:function(){return function(e){var n=document.getElementById("email");n&&e.setFieldValue("email",n.value)}(r)},autoComplete:"new-password"})}),Object(a.jsx)(y.a,{item:!0,xs:12,children:Object(a.jsx)(w.a,{variant:"outlined",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",ref:i,onBlur:function(){return function(e){var n=document.getElementById("password");n&&e.setFieldValue("password",n.value)}(r)},autoComplete:"new-password"})})]}),Object(a.jsx)(g.a,{fullWidth:!0,variant:"contained",color:"primary",className:e.submit,onClick:function(){return l(r.values)},children:"Sign Up"}),Object(a.jsx)(y.a,{container:!0,justify:"flex-end",children:Object(a.jsx)(y.a,{item:!0,children:Object(a.jsx)(I.a,{href:p,variant:"body2",children:"Already have an account? Sign in"})})})]})]})]})}})}var Z=t(341),ee=t(31);function ne(){var e=Object(q.a)(["\n  subscription{\n    newMessage {\n    text\n    date\n    senderName\n  }\n  }\n\n"]);return ne=function(){return e},e}function te(){var e=Object(q.a)(["\n  query getMessages($senderId: String){\n    getMessages(senderId: $senderId){\n      text\n      senderName\n      date\n    }\n  }\n"]);return te=function(){return e},e}function ae(){var e=Object(q.a)(["\n  mutation sendMessage($input: NewMessage!){\n    sendMessage(input: $input){\n      text\n    }\n  }\n"]);return ae=function(){return e},e}var re=F()(ae()),ie=F()(te()),se=F()(ne()),ce=t(80);function oe(){var e=Object(q.a)(["\n  padding-bottom: 10px;\n  padding-top: 10px;\n  border: 1px solid rgb(63, 81, 181);\n  border-radius: 10px;\n  margin-top:10px;\n  margin-bottom:10px;\n"]);return oe=function(){return e},e}function ue(){var e=Object(q.a)(["\n  padding-left:10px;\n  padding-right:10px;\n  list-style:none;\n"]);return ue=function(){return e},e}var le=ce.a.ul(ue()),de=ce.a.li(oe()),je=function(){var e=L.a.get("userId"),n=Object(r.useState)([""]),t=Object(u.a)(n,2),i=t[0],s=t[1],c=Object(V.b)(ie,{variables:{senderId:e}}),o=c.data,l=c.loading;Object(r.useEffect)((function(){s(o.getMessages)}),[l,o]);var d=Object(V.c)(se),j=d.data,p=d.loading;return Object(r.useEffect)((function(){var e=document.getElementById("messageList");if(j&&e){var n=[].concat(Object(ee.a)(i),[j.newMessage]);s(n),e.scrollTop=e.scrollHeight}}),[p,j]),Object(a.jsx)(Z.a,{width:"100vw",height:"70vh",id:"messageList",overflow:"scroll",children:Object(a.jsx)(le,{children:!l&&i&&i.map((function(e,n){return Object(a.jsxs)(de,{children:[Object(a.jsxs)(Z.a,{textAlign:"left",marginLeft:"10px",children:[e.senderName,": "]}),Object(a.jsx)(Z.a,{marginTop:"20px",children:e.text})]},n)}))})})};function pe(){var e=Object(q.a)(["\n  width:300px;\n  border:1px solid #3f51b5;\n  border-radius:5px;\n"]);return pe=function(){return e},e}var be=Object(ce.a)(w.a)(pe()),me={senderId:"",text:""},xe=U.a().shape({text:U.b().required().max(500),senderId:U.b().required()}),he=function(e){e.userId;var n=Object(V.a)(re),t=Object(u.a)(n,1)[0],i=(Object(d.e)(),L.a.get("userId")),s=L.a.get("userName"),c=function(){var e=Object(f.a)(h.a.mark((function e(n,a){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),!n.values.text||n.errors.text){e.next=14;break}return e.prev=2,e.next=5,t({variables:{input:{senderId:i,text:n.values.text,senderName:s}}});case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(2);case 9:return e.prev=9,n.resetForm(),e.finish(9);case 12:e.next=16;break;case 14:H.b.error("Max lenght 500 simbols",{position:H.b.POSITION.BOTTOM_RIGHT}),n.resetForm();case 16:case"end":return e.stop()}}),e,null,[[2,7,9,12]])})));return function(n,t){return e.apply(this,arguments)}}();return Object(a.jsxs)(r.Fragment,{children:[Object(a.jsx)(R.b,{onSubmit:function(e){return console.log(e)},initialValues:me,validationSchema:xe,component:function(e){return Object(a.jsxs)(Z.a,{width:"300px",height:"150px",children:[Object(a.jsx)(be,{id:"sendMessageInput",required:!0,variant:"outlined",autoComplete:"off",onChange:function(){return function(e){var n=document.getElementById("sendMessageInput");n&&e.setFieldValue("text",n.value)}(e)},inputProps:{autoComplete:"none"}}),Object(a.jsx)(Z.a,{marginTop:"10px",children:Object(a.jsx)(g.a,{variant:"contained",color:"primary",onClick:function(n){return c(e,n)},children:"send "})})]})}}),Object(a.jsx)(H.a,{})]})},fe=function(e){var n=e.userId;L.a.get("userId"),Object(d.e)();return Object(a.jsxs)(Z.a,{width:"100vw",height:"90vh",display:"flex",justifyContent:"center",children:[Object(a.jsx)(Z.a,{children:Object(a.jsx)(je,{})}),Object(a.jsx)(Z.a,{position:"fixed",bottom:"0",children:Object(a.jsx)(he,{userId:n})})]})},Oe=function(){var e=Object(d.e)();return Object(a.jsxs)(Z.a,{width:"100vw",height:"50px",bgcolor:"#3f51b5",display:"flex",justifyContent:"center",alignItems:"center",children:[Object(a.jsx)(Z.a,{width:"50vw",display:"flex",justifyContent:"flex-start",marginLeft:"10px",fontSize:"32px",color:"white",fontWeight:"500",children:" WebChat "}),Object(a.jsx)(Z.a,{display:"flex",justifyContent:"flex-end",width:"50vw",children:L.a.get("userId")?Object(a.jsx)(Z.a,{bgcolor:"white",border:"1px solid white",borderRadius:"10px",margin:"5px 10px",height:"40px",textAlign:"center",children:Object(a.jsx)(g.a,{onClick:function(){L.a.remove("userId"),L.a.remove("userName"),e.push(p)},color:"primary",children:"logout"})}):Object(a.jsx)(Z.a,{bgcolor:"white",border:"1px solid white",borderRadius:"10px",margin:"5px 10px",height:"40px",textAlign:"center",children:Object(a.jsx)(g.a,{onClick:function(){e.push(p)},color:"primary",children:"login"})})})]})},ge=function(){var e=Object(r.useState)(null),n=Object(u.a)(e,2),t=n[0],i=n[1];return Object(a.jsxs)(l.a,{children:[Object(a.jsx)(d.a,{path:j,children:Object(a.jsx)(Oe,{})}),Object(a.jsx)(d.a,{path:p,exact:!0,children:Object(a.jsx)(J,{setUserId:i,userId:t})}),Object(a.jsx)(d.a,{path:b,exact:!0,children:Object(a.jsx)(Y,{})}),Object(a.jsx)(d.a,{path:m,exact:!0,children:Object(a.jsx)(fe,{userId:t})})]})},ve=t(116),we=t(28),Ie=t(161),ye=t(52),Se=t(158),ke=t(8),Ce=t(160),Ne=t(159),Te=new Se.a({uri:"ws://localhost:5000/graphql",options:{reconnect:!0,connectionParams:function(){return{autorization:L.a.get("token")?"Bearer ".concat(L.a.get("token")):""}}}}),qe=new Ie.a({uri:"http://localhost:5000/graphql"}),Be=Object(Ne.a)((function(e,n){var t=n.headers,a=L.a.get("token");return{headers:Object(ve.a)(Object(ve.a)({},t),{},{autorization:a?"Bearer ".concat(a):""})}})),Fe=Object(we.d)((function(e){var n=e.query,t=Object(ke.j)(n);return"OperationDefinition"===t.kind&&"subscription"===t.operation}),Te,Be.concat(qe)),Me=new ye.a({cache:new Ce.a,link:Fe});var Ee=function(){return Object(a.jsx)(o.a,{client:Me,children:Object(a.jsx)("div",{className:"App",children:Object(a.jsx)(ge,{})})})},We=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,346)).then((function(n){var t=n.getCLS,a=n.getFID,r=n.getFCP,i=n.getLCP,s=n.getTTFB;t(e),a(e),r(e),i(e),s(e)}))};c.a.render(Object(a.jsx)(i.a.StrictMode,{children:Object(a.jsx)(Ee,{})}),document.getElementById("root")),We()}},[[303,1,2]]]);
//# sourceMappingURL=main.a5a29cf5.chunk.js.map