(this.webpackJsonpclientchat=this.webpackJsonpclientchat||[]).push([[0],{208:function(e,t,n){},209:function(e,t,n){},326:function(e,t,n){"use strict";n.r(t);var a=n(3),r=n(0),i=n.n(r),c=n(19),s=n.n(c),o=(n(208),n(209),n(33)),u=n(20),l=n(68),d=n(22),j="/",b="/login",p="/register",m="/chat",x=n(45),h=n.n(x),f=n(56),O=n(371),g=n(369),v=n(363),w=n(366),C=n(365),I=n(364),y=n(117),k=n.n(y),S=n(332),N=n(358),T=n(361),M=n(31),E=n(46),A=n.n(E);function q(){var e=Object(M.a)(["\n  mutation userSignIn($input: UserSignInInput!){\n    userSignIn(input: $input){\n      id\n      userName\n      token\n    }\n  }\n"]);return q=function(){return e},e}function B(){var e=Object(M.a)(["\n  mutation createUser($input: NewUser!){\n    createUser(input: $input)\n  }\n"]);return B=function(){return e},e}var F=A()(B()),L=A()(q()),$=n(32),z=n(65),P=n(43),W=n(77),V=n.n(W),H=n(27),U=n.n(H),_=n(41),R=(n(129),n(360)),Z={email:"",password:""},D=P.a().shape({email:P.b().required().matches(/^([a-zA-Z0-9_\-\.]+)@([a-zA-Z0-9_\-\.]+)\.([a-zA-Z]{2,5})$/),password:P.b().required().min(6)}),G=Object(N.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));function J(){var e=G(),t=Object(d.e)(),n=Object($.a)(L),i=Object(u.a)(n,1)[0],c=Object(R.a)().messages,s=function(){var e=Object(f.a)(h.a.mark((function e(n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.errors.email||n.errors.password){e.next=11;break}return e.prev=1,e.next=4,i({variables:{input:{email:n.values.email,password:n.values.password}}}).then((function(e){V()(e,"data.userSignIn")&&(U.a.set("userId",V()(e,"data.userSignIn.id")),U.a.set("userName",V()(e,"data.userSignIn.userName")),U.a.set("token",V()(e,"data.userSignIn.token")),t.push(m))}));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),_.b.error("".concat(c.incorrectEmail),{position:_.b.POSITION.BOTTOM_RIGHT});case 9:e.next=12;break;case 11:_.b.error("".concat(c.incorrectEmail),{position:_.b.POSITION.BOTTOM_RIGHT});case 12:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsxs)(r.Fragment,{children:[Object(a.jsx)(z.b,{onSubmit:function(e){return console.log(e)},initialValues:Z,validationSchema:D,component:function(t){return Object(a.jsxs)(T.a,{component:"main",maxWidth:"xs",children:[Object(a.jsx)(v.a,{}),Object(a.jsxs)("div",{className:e.paper,children:[Object(a.jsx)(O.a,{className:e.avatar,children:Object(a.jsx)(k.a,{})}),Object(a.jsx)(S.a,{component:"h1",variant:"h5",children:"Sign in"}),Object(a.jsxs)("form",{className:e.form,noValidate:!0,children:[Object(a.jsx)(w.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"".concat(c.emailLong),name:"email",autoComplete:"new-password",inputProps:{form:{autocomplete:"off"}},onChange:function(){return function(e){var t=document.getElementById("email");t&&e.setFieldValue("email",t.value)}(t)},autoFocus:!0}),Object(a.jsx)(w.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",onChange:function(){return function(e){var t=document.getElementById("password");t&&e.setFieldValue("password",t.value)}(t)},autoComplete:"new-password"}),Object(a.jsx)(g.a,{fullWidth:!0,variant:"contained",color:"primary",className:e.submit,onClick:function(){return s(t)},children:"".concat(c.signIn)}),Object(a.jsx)(I.a,{container:!0,children:Object(a.jsx)(I.a,{item:!0,children:Object(a.jsx)(C.a,{href:p,variant:"body2",children:"".concat(c.dontHaveAccount)})})})]})]})]})}}),Object(a.jsx)(_.a,{})]})}var K={email:"",password:"",name:""},Q=P.a().shape({email:P.b().required().matches(/^([a-zA-Z0-9_\-\.]+)@([a-zA-Z0-9_\-\.]+)\.([a-zA-Z]{2,5})$/),password:P.b().required().min(6),name:P.b().required()}),X=Object(N.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(3)},submit:{margin:e.spacing(3,0,2)}}}));function Y(){var e=X(),t=Object($.a)(F),n=Object(u.a)(t,1)[0],i=Object(d.e)(),c=Object(R.a)().messages,s=function(){var e=Object(f.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.errors.email||t.errors.name||t.errors.password){e.next=13;break}return e.prev=1,e.next=4,n({variables:{input:{email:t.values.email,name:t.values.name,password:t.values.password}}});case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:return e.prev=8,i.push(b),e.finish(8);case 11:e.next=14;break;case 13:_.b.error("".concat(c.incorrectEmail),{position:_.b.POSITION.BOTTOM_RIGHT});case 14:case"end":return e.stop()}}),e,null,[[1,6,8,11]])})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsxs)(r.Fragment,{children:[Object(a.jsx)(z.b,{onSubmit:function(){return n()},initialValues:K,validationSchema:Q,component:function(t){return Object(a.jsxs)(T.a,{component:"main",maxWidth:"xs",children:[Object(a.jsx)(v.a,{}),Object(a.jsxs)("div",{className:e.paper,children:[Object(a.jsx)(O.a,{className:e.avatar,children:Object(a.jsx)(k.a,{})}),Object(a.jsx)(S.a,{component:"h1",variant:"h5",children:"".concat(c.signUp)}),Object(a.jsxs)(z.a,{id:"test",className:e.form,children:[Object(a.jsxs)(I.a,{container:!0,spacing:2,children:[Object(a.jsx)(I.a,{item:!0,xs:12,children:Object(a.jsx)(w.a,{name:"name",variant:"outlined",required:!0,fullWidth:!0,id:"name",label:"".concat(c.name),autoFocus:!0,onBlur:function(){return function(e){var t=document.getElementById("name");t&&e.setFieldValue("name",t.value)}(t)},inputProps:{autoComplete:"off"}})}),Object(a.jsx)(I.a,{item:!0,xs:12,children:Object(a.jsx)(w.a,{variant:"outlined",required:!0,fullWidth:!0,id:"email",label:"".concat(c.emailLong),name:"email",onBlur:function(){return function(e){var t=document.getElementById("email");t&&e.setFieldValue("email",t.value)}(t)},autoComplete:"new-password"})}),Object(a.jsx)(I.a,{item:!0,xs:12,children:Object(a.jsx)(w.a,{variant:"outlined",required:!0,fullWidth:!0,name:"password",label:"".concat(c.password),type:"password",id:"password",onBlur:function(){return function(e){var t=document.getElementById("password");t&&e.setFieldValue("password",t.value)}(t)},autoComplete:"new-password"})})]}),Object(a.jsx)(g.a,{fullWidth:!0,variant:"contained",color:"primary",className:e.submit,onClick:function(){return s(t)},children:"".concat(c.signUp)}),Object(a.jsx)(I.a,{container:!0,justify:"flex-end",children:Object(a.jsx)(I.a,{item:!0,children:Object(a.jsx)(C.a,{href:b,variant:"body2",children:"".concat(c.alreadyHaveAccount)})})})]})]})]})}}),Object(a.jsx)(_.a,{})]})}var ee=n(367),te=n(38);function ne(){var e=Object(M.a)(["\n  subscription{\n      newMessage {\n      text\n      date\n      senderName\n    }\n  }\n"]);return ne=function(){return e},e}function ae(){var e=Object(M.a)(["\n  query getMessages($chatId: String){\n    getMessages(chatId: $chatId){\n      text\n      date\n      senderName\n    }\n  }\n"]);return ae=function(){return e},e}function re(){var e=Object(M.a)(["\n  mutation sendMessage($input: NewMessage!){\n    sendMessage(input: $input){\n      text\n    }\n  }\n"]);return re=function(){return e},e}var ie=A()(re()),ce=A()(ae()),se=A()(ne()),oe=n(91);function ue(){var e=Object(M.a)(["\n  padding-bottom: 10px;\n  padding-top: 10px;\n  border: 1px solid rgb(63, 81, 181);\n  border-radius: 10px;\n  margin-top:10px;\n  margin-bottom:10px;\n"]);return ue=function(){return e},e}function le(){var e=Object(M.a)(["\n  padding-left:10px;\n  padding-right:10px;\n  list-style:none;\n"]);return le=function(){return e},e}var de=oe.a.ul(le()),je=oe.a.li(ue()),be=function(e){var t=e.currentChat,n=Object(r.useState)([""]),i=Object(u.a)(n,2),c=i[0],s=i[1],o=Object($.b)(ce,{variables:{chatId:t}}),l=o.data,d=o.loading;Object(r.useEffect)((function(){t&&s(l.getMessages)}),[d,l,t]);var j=Object($.c)(se),b=j.data,p=j.loading;return Object(r.useEffect)((function(){var e=document.getElementById("messageList");if(b&&e){var t=[].concat(Object(te.a)(c),[b.newMessage]);s(t),e.scrollTop=e.scrollHeight}}),[p,b]),Object(a.jsx)(ee.a,{width:"100%",height:"80vh",id:"messageList",overflow:"scroll",children:Object(a.jsx)(de,{children:!d&&c&&t&&c.map((function(e,t){return Object(a.jsxs)(je,{children:[Object(a.jsxs)(ee.a,{textAlign:"left",marginLeft:"10px",padding:"5px",children:[e.senderName,": "]}),Object(a.jsx)(ee.a,{marginTop:"20px",padding:"5px",children:e.text})]},t)}))})})};function pe(){var e=Object(M.a)(["\n  width:300px;\n  border:1px solid #3f51b5;\n  border-radius:5px;\n  margin-bottom: 10px;\n"]);return pe=function(){return e},e}var me=Object(oe.a)(w.a)(pe()),xe={chatId:"",text:""},he=P.a().shape({text:P.b().required().max(500),senderId:P.b().required()}),fe=function(e){var t=e.currentChat,n=Object($.a)(ie),i=Object(u.a)(n,1)[0],c=Object(R.a)().messages,s=function(){var e=Object(f.a)(h.a.mark((function e(n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.values.text||n.errors.text){e.next=13;break}return e.prev=1,e.next=4,i({variables:{input:{chatId:t,text:n.values.text}}});case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:return e.prev=8,n.resetForm(),e.finish(8);case 11:e.next=15;break;case 13:_.b.error("Max lenght 500 simbols",{position:_.b.POSITION.BOTTOM_RIGHT}),n.resetForm();case 15:case"end":return e.stop()}}),e,null,[[1,6,8,11]])})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsxs)(r.Fragment,{children:[Object(a.jsx)(z.b,{onSubmit:function(){return i()},initialValues:xe,validationSchema:he,component:function(e){return Object(a.jsxs)(ee.a,{width:"300px",marginTop:"10px",children:[Object(a.jsx)(me,{id:"sendMessageInput",required:!0,variant:"outlined",onChange:function(){return function(e){var t=document.getElementById("sendMessageInput");t&&e.setFieldValue("text",t.value)}(e)},inputProps:{autoComplete:"off"}}),Object(a.jsx)(ee.a,{marginTop:"10px",marginBottom:"10px",children:Object(a.jsx)(g.a,{variant:"contained",color:"primary",onClick:function(){return s(e)},children:"".concat(c.send)})})]})}}),Object(a.jsx)(_.a,{})]})};function Oe(){var e=Object(M.a)(["\n subscription{\n   newChat{\n    id\n      senderName\n      recipientName\n      senderId\n      recipientId\n   }\n  }\n"]);return Oe=function(){return e},e}function ge(){var e=Object(M.a)(["\n  mutation createChat($input: NewChatInput!){\n    createChat(input: $input){\n      id\n    }\n  }\n"]);return ge=function(){return e},e}function ve(){var e=Object(M.a)(["\n  query users{\n    users{\n      name\n      id\n      email\n    }\n  }\n"]);return ve=function(){return e},e}function we(){var e=Object(M.a)(["\n  query getMyChats($token: String!){\n    getMyChats(token: $token){\n      id\n      senderName\n      recipientName\n      senderId\n      recipientId\n    }\n  }\n"]);return we=function(){return e},e}var Ce=A()(we()),Ie=A()(ve()),ye=A()(ge()),ke=A()(Oe()),Se=Object(N.a)({user:{border:"1px solid #3f51b5",margin:"10px"}}),Ne=function(e){var t=e.isListClose,n=e.setCurrentChat,i=U.a.get("userId"),c=Object(r.useState)([""]),s=Object(u.a)(c,2),o=s[0],l=s[1],d=Se(),j=Object($.b)(Ce,{variables:{token:U.a.get("token")}}),b=j.data,p=j.loading,m=Object($.c)(ke),x=m.data,h=m.loading;return Object(r.useEffect)((function(){l(b.getMyChats)}),[p,b]),Object(r.useEffect)((function(){if(x){var e=[].concat(Object(te.a)(o),[x.newChat]);l(e)}}),[x,h]),Object(a.jsx)(ee.a,{overflow:"scroll",children:!p&&o&&!t&&o.map((function(e,t){return Object(a.jsx)("ul",{onClick:function(){return n(e.id)},className:d.user,children:Object(a.jsx)(ee.a,{textAlign:"left",marginLeft:"10px",padding:"5px",children:i===e.senderId?e.recipientName:e.senderName})},t)}))})},Te=n(179),Me=n.n(Te),Ee=function(e){var t=e.isListClose,n=e.setModalActive;return Object(a.jsx)(ee.a,{display:"flex",justifyContent:"flex-start",margin:"10px",children:!t&&Object(a.jsx)(Me.a,{onClick:function(){return n(!0)}})})},Ae=n(181),qe=n.n(Ae),Be=n(370),Fe=n(180),Le=n.n(Fe),$e=Object(N.a)({userList:{listStyle:"none"},user:{padding:"10px",border:"1px solid #3f51b5",margin:"5px",marginRight:"30px"}}),ze=function(e){var t=e.setModalActive,n=e.isModalActive,r=Object($.b)(Ie),i=r.data,c=r.loading,s=$e(),o=Object($.a)(ye),l=Object(u.a)(o,1)[0],d=function(){var e=Object(f.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.target)try{l({variables:{input:{recipientId:t.target.id}}})}catch(n){}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsx)(Be.a,{open:n,children:Object(a.jsx)(ee.a,{width:"100vw",height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",children:Object(a.jsxs)(ee.a,{width:"300px",height:"300px",overflow:"scroll",bgcolor:"white",children:[Object(a.jsx)(ee.a,{position:"fixed",marginLeft:"10px",marginTop:"10px",children:Object(a.jsx)(Le.a,{onClick:function(){return t(!1)}})}),Object(a.jsx)("ul",{className:s.userList,onClick:d,children:!c&&i.users&&i.users.map((function(e){return Object(a.jsxs)("li",{className:s.user,id:e.id,children:[e.email," : ",e.name]},e.id)}))})]})})})},Pe=function(e){var t=e.setCurrentChat,n=Object(r.useState)(!1),i=Object(u.a)(n,2),c=i[0],s=i[1],o=Object(r.useState)(!1),l=Object(u.a)(o,2),d=l[0],j=l[1];return Object(a.jsxs)(ee.a,{border:"1px solid #3f51b5",width:c?"50px":"300px",height:"100vh",zIndex:10,children:[Object(a.jsx)(ee.a,{display:"flex",justifyContent:"flex-end",margin:"10px",children:Object(a.jsx)(qe.a,{onClick:function(){s(!c)}})}),Object(a.jsx)(Ee,{isListClose:c,setModalActive:j}),Object(a.jsx)(Ne,{isListClose:c,setCurrentChat:t}),Object(a.jsx)(ze,{isModalActive:d,setModalActive:j})]})},We=function(e){var t=e.currentChat,n=e.setCurrentChat,i=U.a.get("userId"),c=Object(d.e)();return Object(r.useEffect)((function(){!i&&c.push(b)}),[c,i]),Object(a.jsxs)(ee.a,{width:"100vw",display:"flex",justifyContent:"center",zIndex:0,children:[Object(a.jsxs)(ee.a,{display:"flex",width:"100vw",children:[Object(a.jsx)(Pe,{setCurrentChat:n}),Object(a.jsx)(be,{currentChat:t})]}),Object(a.jsx)(ee.a,{width:"100vw",position:"fixed",zIndex:"10",bgcolor:"white",bottom:"0",display:"flex",justifyContent:"center",children:t&&Object(a.jsx)(fe,{currentChat:t})})]})},Ve=function(){var e=Object(R.a)().messages,t=Object(d.e)(),n=Object(r.useState)(!1),i=Object(u.a)(n,2),c=i[0],s=i[1],o=Object(r.useState)(!1),l=Object(u.a)(o,2),j=l[0],p=l[1];Object(r.useEffect)((function(){var e=U.a.get("userId");U.a.get("userName")&&e&&(t.push(m),s(!0))}),[]),Object(r.useEffect)((function(){p(!window.location.href.includes(b))}),[]);return Object(a.jsxs)(ee.a,{width:"100vw",height:"50px",bgcolor:"#3f51b5",display:"flex",justifyContent:"center",alignItems:"center",children:[Object(a.jsxs)(ee.a,{width:"50vw",display:"flex",justifyContent:"flex-start",marginLeft:"10px",fontSize:"32px",color:"white",fontWeight:"500",children:[" ","".concat(e.webChat)," "]}),Object(a.jsx)(ee.a,{display:"flex",justifyContent:"flex-end",width:"50vw",children:j&&Object(a.jsx)(ee.a,{bgcolor:"white",borderRadius:"10px",margin:"10px",height:"35px",textAlign:"center",children:Object(a.jsx)(g.a,{onClick:c?function(){U.a.remove("userId"),U.a.remove("userName"),U.a.remove("token"),t.push(b),s(!1)}:function(){s(!0),t.push(b)},color:"primary",children:"".concat(c?e.signOut:e.signIn)})})})]})},He=function(){var e=Object(r.useState)(null),t=Object(u.a)(e,2),n=t[0],i=t[1];return Object(a.jsxs)(l.a,{children:[Object(a.jsx)(d.a,{path:j,children:Object(a.jsx)(Ve,{})}),Object(a.jsx)(d.a,{path:b,exact:!0,children:Object(a.jsx)(J,{})}),Object(a.jsx)(d.a,{path:p,exact:!0,children:Object(a.jsx)(Y,{})}),Object(a.jsx)(d.a,{path:m,exact:!0,children:Object(a.jsx)(We,{currentChat:n,setCurrentChat:i})})]})},Ue=n(92),_e=n(35),Re=n(185),Ze=n(60),De=n(182),Ge=n(8),Je=n(184),Ke=n(183),Qe=new De.a({uri:"ws://localhost:5000/graphql",options:{reconnect:!0,connectionParams:function(){return{autorization:U.a.get("token")?"Bearer ".concat(U.a.get("token")):""}}}}),Xe=new Re.a({uri:"http://localhost:5000/graphql"}),Ye=Object(Ke.a)((function(e,t){var n=t.headers,a=U.a.get("token");return{headers:Object(Ue.a)(Object(Ue.a)({},n),{},{autorization:a?"Bearer ".concat(a):""})}})),et=Object(_e.d)((function(e){var t=e.query,n=Object(Ge.j)(t);return"OperationDefinition"===n.kind&&"subscription"===n.operation}),Qe,Ye.concat(Xe)),tt=new Ze.a({cache:new Je.a,link:et}),nt=n(368),at="en-us",rt=n(119),it=Object(rt.a)({},at,{signIn:"Sign in",signUp:"Sign up",signOut:"Sign out",email:"Email",emailLong:"Email address",password:"Password",name:"Name",alreadyHaveAccount:"Already have an account? Sign in",dontHaveAccount:"Don't have an account? Sign Up",incorrectEmail:"Email or password entered incorrect",webChat:"WebChat",send:"Send"}),ct=Object(Ue.a)({},it),st=function(e){var t=e.children,n=e.locale,i=void 0===n?at:n;return Object(a.jsx)(nt.a,{locale:i,textComponent:r.Fragment,messages:ct[i],children:t})};var ot=function(){return Object(a.jsx)(o.a,{client:tt,children:Object(a.jsx)(st,{locale:at,children:Object(a.jsx)("div",{className:"App",children:Object(a.jsx)(He,{})})})})},ut=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,374)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),a(e),r(e),i(e),c(e)}))};s.a.render(Object(a.jsx)(i.a.StrictMode,{children:Object(a.jsx)(ot,{})}),document.getElementById("root")),ut()}},[[326,1,2]]]);
//# sourceMappingURL=main.f9679a02.chunk.js.map